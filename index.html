<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Xab Wallet</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
  color: white;
  min-height: 100vh;
  background: linear-gradient(180deg, #0b1f2a 0%, #123847 40%, #0b1f2a 100%);
  background-attachment: fixed;
}

.screen {
  display: none;
  min-height: 100vh;
  padding: 16px;
  padding-bottom: 90px;
  box-sizing: border-box;
}

.screen.active {
  display: block;
}

h2 {
  margin-top: 0;
  font-size: 22px;
}

.balance {
  font-size: 18px;
  margin-bottom: 16px;
}

.task, .bonus-box {
  background: rgba(255, 255, 255, 0.08);
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 14px;
  backdrop-filter: blur(6px);
}

.task-title {
  font-weight: 600;
  margin-bottom: 6px;
}

.task-reward {
  font-size: 14px;
  opacity: 0.8;
}

button {
  margin-top: 10px;
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: #2ea6ff;
  color: white;
  font-size: 16px;
}

button:disabled {
  opacity: 0.5;
}

.profile-item {
  margin-bottom: 12px;
  font-size: 16px;
}

.nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 70px;
  background: rgba(10, 20, 30, 0.9);
  backdrop-filter: blur(8px);
  display: flex;
  justify-content: space-around;
  align-items: center;
  border-top: 1px solid rgba(255,255,255,0.1);
}

.nav button {
  background: none;
  border: none;
  color: white;
  font-size: 14px;
  opacity: 0.6;
}

.nav button.active {
  opacity: 1;
  font-weight: 600;
}
</style>
</head>

<body>

<!-- –ó–ê–î–ê–ù–ò–Ø -->
<div id="tasksScreen" class="screen active">
  <h2>–ó–∞–¥–∞–Ω–∏—è</h2>
  <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span></div>
  <div id="tasks"></div>
</div>

<!-- –ë–û–ù–£–°–´ -->
<div id="bonusScreen" class="screen">
  <h2>–ë–æ–Ω—É—Å—ã</h2>

  <div class="bonus-box">
    <div style="font-size:16px; margin-bottom:6px;">üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</div>
    <div id="bonusTimer" style="font-size:14px; opacity:0.8;"></div>
    <button id="bonusBtn" onclick="claimBonus()">–ü–æ–ª—É—á–∏—Ç—å 0.01 TON üéÅ</button>
  </div>
</div>

<!-- –ü–†–û–§–ò–õ–¨ -->
<div id="profileScreen" class="screen">
  <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
  <div class="profile-item">üÜî ID: <b id="profileId"></b></div>
  <div class="profile-item">üë§ –ò–º—è: <b id="profileName"></b></div>
  <div class="profile-item">üí∞ –ë–∞–ª–∞–Ω—Å: <b><span id="profileBalance">0</span></b></div>
</div>

<!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
<div class="nav">
  <button id="btnTasks" class="active" onclick="showScreen('tasks')">–ó–∞–¥–∞–Ω–∏—è</button>
  <button id="btnBonus" onclick="showScreen('bonus')">–ë–æ–Ω—É—Å—ã</button>
  <button id="btnProfile" onclick="showScreen('profile')">–ü—Ä–æ—Ñ–∏–ª—å</button>
</div>

<script>
const tg = Telegram.WebApp;
tg.ready();

const user = tg.initDataUnsafe?.user || {};
const userId = user.id || "guest";
const userName = user.first_name || "–ë–µ–∑ –∏–º–µ–Ω–∏";

document.getElementById("profileId").innerText = userId;
document.getElementById("profileName").innerText = userName;

const balanceKey = `balance_${userId}`;
const tasksKey = `tasks_${userId}`;
const bonusKey = `bonus_${userId}`;

let balance = parseFloat(localStorage.getItem(balanceKey)) || 0;
let completedTasks = JSON.parse(localStorage.getItem(tasksKey)) || [];
let lastBonus = parseInt(localStorage.getItem(bonusKey)) || 0;

const tasks = [
  { id: 1, title: "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ Telegram –∫–∞–Ω–∞–ª", reward: 10 },
  { id: 2, title: "–û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç –ø–∞—Ä—Ç–Ω—ë—Ä–∞", reward: 15 },
  { id: 3, title: "–ó–∞–π—Ç–∏ –≤ –±–æ—Ç–∞", reward: 5 }
];

function save() {
  localStorage.setItem(balanceKey, balance);
  localStorage.setItem(tasksKey, JSON.stringify(completedTasks));
  localStorage.setItem(bonusKey, lastBonus);
}

function renderTasks() {
  document.getElementById("balance").innerText = balance.toFixed(2);
  document.getElementById("profileBalance").innerText = balance.toFixed(2);

  const container = document.getElementById("tasks");
  container.innerHTML = "";

  tasks.forEach(task => {
    if (completedTasks.includes(task.id)) return;

    const div = document.createElement("div");
    div.className = "task";
    div.innerHTML = `
      <div class="task-title">${task.title}</div>
      <div class="task-reward">+${task.reward}</div>
      <button>–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
    `;

    div.querySelector("button").onclick = () => {
      completedTasks.push(task.id);
      balance += task.reward;
      save();
      renderTasks();
    };

    container.appendChild(div);
  });
}

/* –ë–û–ù–£–° */
function updateBonus() {
  const now = Date.now();
  const diff = 86400000 - (now - lastBonus);
  const btn = document.getElementById("bonusBtn");
  const timer = document.getElementById("bonusTimer");

  if (diff <= 0) {
    btn.disabled = false;
    timer.innerText = "–ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å üéâ";
  } else {
    btn.disabled = true;
    const h = Math.floor(diff / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    timer.innerText = `–î–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ ${h}—á ${m}–º ${s}—Å`;
  }
}

function claimBonus() {
  lastBonus = Date.now();
  balance += 0.01;
  save();
  renderTasks();
  updateBonus();
}

setInterval(updateBonus, 1000);

/* –ù–ê–í */
function showScreen(name) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.querySelectorAll(".nav button").forEach(b => b.classList.remove("active"));

  if (name === "tasks") { tasksScreen.classList.add("active"); btnTasks.classList.add("active"); }
  if (name === "bonus") { bonusScreen.classList.add("active"); btnBonus.classList.add("active"); }
  if (name === "profile") { profileScreen.classList.add("active"); btnProfile.classList.add("active"); }
}

renderTasks();
updateBonus();
</script>

</body>
</html>
